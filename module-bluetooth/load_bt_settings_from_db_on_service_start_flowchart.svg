<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="591px" preserveAspectRatio="none" style="width:834px;height:591px;background:#F0F0F0;" version="1.1" viewBox="0 0 834 591" width="834px" zoomAndPan="magnify"><defs><filter height="300%" id="fxmka0jrkuew8" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fxmka0jrkuew8)" height="203.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="49.5" y="141.6953"/><rect fill="#FFFFFF" filter="url(#fxmka0jrkuew8)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="49.5" y="374.7578"/><rect fill="#FFFFFF" filter="url(#fxmka0jrkuew8)" height="116.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="402.5" y="112.5625"/><rect fill="#FFFFFF" filter="url(#fxmka0jrkuew8)" height="233.0625" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="402.5" y="258.2266"/><rect fill="#FFFFFF" filter="url(#fxmka0jrkuew8)" height="35.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="632.5" y="491.2891"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="54" x2="54" y1="38.2969" y2="551.4219"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="407.5" x2="407.5" y1="38.2969" y2="551.4219"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="637" x2="637" y1="38.2969" y2="551.4219"/><rect fill="#FEFECE" filter="url(#fxmka0jrkuew8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="89" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="75" x="15" y="22.9951">Service DB</text><rect fill="#FEFECE" filter="url(#fxmka0jrkuew8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="89" x="8" y="550.4219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="75" x="15" y="570.417">Service DB</text><rect fill="#FEFECE" filter="url(#fxmka0jrkuew8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="337.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="344.5" y="22.9951">Service Bluetooth</text><rect fill="#FEFECE" filter="url(#fxmka0jrkuew8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="337.5" y="550.4219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="344.5" y="570.417">Service Bluetooth</text><rect fill="#FEFECE" filter="url(#fxmka0jrkuew8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="135" x="568" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="575" y="22.9951">Bluetooth Worker</text><rect fill="#FEFECE" filter="url(#fxmka0jrkuew8)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="135" x="568" y="550.4219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="575" y="570.417">Bluetooth Worker</text><rect fill="#FFFFFF" filter="url(#fxmka0jrkuew8)" height="203.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="49.5" y="141.6953"/><rect fill="#FFFFFF" filter="url(#fxmka0jrkuew8)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="49.5" y="374.7578"/><rect fill="#FFFFFF" filter="url(#fxmka0jrkuew8)" height="116.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="402.5" y="112.5625"/><rect fill="#FFFFFF" filter="url(#fxmka0jrkuew8)" height="233.0625" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="402.5" y="258.2266"/><rect fill="#FFFFFF" filter="url(#fxmka0jrkuew8)" height="35.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="632.5" y="491.2891"/><rect fill="#EEEEEE" filter="url(#fxmka0jrkuew8)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="819.5" x="3" y="68.8633"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="822.5" y1="68.8633" y2="68.8633"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="822.5" y1="71.8633" y2="71.8633"/><rect fill="#EEEEEE" filter="url(#fxmka0jrkuew8)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="315" x="255.25" y="58.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="296" x="261.25" y="74.3638">Load Bluetooth Settings on startup flow</text><ellipse cx="10.5" cy="111.8125" fill="none" rx="4" ry="4" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#A80036" points="390.5,108.5625,400.5,112.5625,390.5,116.5625,394.5,112.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="15" x2="396.5" y1="112.5625" y2="112.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="18" y="107.4966">need Bluetooth Settings</text><polygon fill="#A80036" points="70.5,137.6953,60.5,141.6953,70.5,145.6953,66.5,141.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64.5" x2="401.5" y1="141.6953" y2="141.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="301" x="76.5" y="136.6294">Settings::registerValueChange(bluetoothState)</text><polygon fill="#A80036" points="70.5,166.8281,60.5,170.8281,70.5,174.8281,66.5,170.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64.5" x2="401.5" y1="170.8281" y2="170.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="297" x="76.5" y="165.7622">Settings::registerValueChange(deviceVisibility)</text><polygon fill="#A80036" points="70.5,195.9609,60.5,199.9609,70.5,203.9609,66.5,199.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64.5" x2="401.5" y1="199.9609" y2="199.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="285" x="76.5" y="194.895">Settings::registerValueChange(deviceName)</text><polygon fill="#A80036" points="70.5,225.0938,60.5,229.0938,70.5,233.0938,66.5,229.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64.5" x2="406.5" y1="229.0938" y2="229.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="303" x="76.5" y="224.0278">Settings::registerValueChange(bondedDevices)</text><polygon fill="#A80036" points="390.5,254.2266,400.5,258.2266,390.5,262.2266,394.5,258.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="59.5" x2="396.5" y1="258.2266" y2="258.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="312" x="66.5" y="253.1606">activate callback with new value (bluetoothState)</text><polygon fill="#A80036" points="390.5,283.3594,400.5,287.3594,390.5,291.3594,394.5,287.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="59.5" x2="396.5" y1="287.3594" y2="287.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="308" x="66.5" y="282.2935">activate callback with new value (deviceVisibility)</text><polygon fill="#A80036" points="390.5,312.4922,400.5,316.4922,390.5,320.4922,394.5,316.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="59.5" x2="396.5" y1="316.4922" y2="316.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="296" x="66.5" y="311.4263">activate callback with new value (deviceName)</text><polygon fill="#A80036" points="390.5,341.625,400.5,345.625,390.5,349.625,394.5,345.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="54.5" x2="396.5" y1="345.625" y2="345.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="314" x="61.5" y="340.5591">activate callback with new value (bondedDevices)</text><polygon fill="#A80036" points="70.5,370.7578,60.5,374.7578,70.5,378.7578,66.5,374.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64.5" x2="401.5" y1="374.7578" y2="374.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="317" x="76.5" y="369.6919">Settings::unregisterValueChange(bluetoothState)</text><polygon fill="#A80036" points="70.5,399.8906,60.5,403.8906,70.5,407.8906,66.5,403.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64.5" x2="401.5" y1="403.8906" y2="403.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="313" x="76.5" y="398.8247">Settings::unregisterValueChange(deviceVisibility)</text><polygon fill="#A80036" points="70.5,429.0234,60.5,433.0234,70.5,437.0234,66.5,433.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64.5" x2="401.5" y1="433.0234" y2="433.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="301" x="76.5" y="427.9575">Settings::unregisterValueChange(deviceName)</text><polygon fill="#A80036" points="65.5,458.1563,55.5,462.1563,65.5,466.1563,61.5,462.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="59.5" x2="401.5" y1="462.1563" y2="462.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="319" x="71.5" y="457.0903">Settings::unregisterValueChange(bondedDevices)</text><polygon fill="#A80036" points="620.5,487.2891,630.5,491.2891,620.5,495.2891,624.5,491.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="407.5" x2="626.5" y1="491.2891" y2="491.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="414.5" y="486.2231">Pass cached Bluetooth settings</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="642.5" x2="684.5" y1="525.4219" y2="525.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="684.5" x2="684.5" y1="525.4219" y2="538.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="637.5" x2="684.5" y1="538.4219" y2="538.4219"/><polygon fill="#A80036" points="647.5,534.4219,637.5,538.4219,647.5,542.4219,643.5,538.4219" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="649.5" y="520.356">reload Bluetooth settings</text><!--MD5=[8101b28755652170bddc2ca6e3160411]
@startuml
skinparam BackgroundColor F0F0F0

participant "Service DB" as srvdb
participant "Service Bluetooth" as srvbt
participant "Bluetooth Worker" as btwrkr

    == Load Bluetooth Settings on startup flow ==

[o->srvbt : need Bluetooth Settings
activate srvbt
srvbt -> srvdb : Settings::registerValueChange(bluetoothState)
    activate srvdb
srvbt -> srvdb : Settings::registerValueChange(deviceVisibility)
srvbt -> srvdb : Settings::registerValueChange(deviceName)
srvbt -> srvdb : Settings::registerValueChange(bondedDevices)

deactivate srvbt

srvbt <- srvdb : activate callback with new value (bluetoothState)
activate srvbt
srvbt <- srvdb : activate callback with new value (deviceVisibility)
srvbt <- srvdb : activate callback with new value (deviceName)
srvbt <- srvdb : activate callback with new value (bondedDevices)
deactivate srvdb

srvbt -> srvdb : Settings::unregisterValueChange(bluetoothState)
    activate srvdb
srvbt -> srvdb : Settings::unregisterValueChange(deviceVisibility)
srvbt -> srvdb : Settings::unregisterValueChange(deviceName)
srvbt -> srvdb : Settings::unregisterValueChange(bondedDevices)

deactivate srvdb

srvbt -> btwrkr : Pass cached Bluetooth settings

deactivate srvbt
activate btwrkr
btwrkr -> btwrkr : reload Bluetooth settings

deactivate btwrkr

@enduml

PlantUML version 1.2020.02(Sun Mar 01 05:22:07 EST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.12+7-post-Debian-2
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>