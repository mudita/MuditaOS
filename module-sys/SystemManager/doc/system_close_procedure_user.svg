<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="672px" preserveAspectRatio="none" style="width:1152px;height:672px;" version="1.1" viewBox="0 0 1152 672" width="1152px" zoomAndPan="magnify"><defs><filter height="300%" id="f13kgozwf63std" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f13kgozwf63std)" height="59.2656" style="stroke:#000000;stroke-width:2.0;" width="182.5" x="359" y="380.4922"/><rect fill="#FFFFFF" filter="url(#f13kgozwf63std)" height="59.2656" style="stroke:#000000;stroke-width:2.0;" width="160.5" x="359" y="512.0234"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="24" x2="24" y1="88.2969" y2="588.2891"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="133" x2="133" y1="88.2969" y2="588.2891"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="256" x2="256" y1="88.2969" y2="588.2891"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="435" x2="435" y1="88.2969" y2="588.2891"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="626.5" x2="626.5" y1="88.2969" y2="588.2891"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="782" x2="782" y1="88.2969" y2="588.2891"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="968.5" x2="968.5" y1="88.2969" y2="588.2891"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1091.5" x2="1091.5" y1="88.2969" y2="588.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="5" y="84.9951">User</text><ellipse cx="24" cy="15" fill="#FEFECE" filter="url(#f13kgozwf63std)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M24,23 L24,50 M11,31 L37,31 M24,50 L11,65 M24,50 L37,65 " fill="none" filter="url(#f13kgozwf63std)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="5" y="600.2842">User</text><ellipse cx="24" cy="613.5859" fill="#FEFECE" filter="url(#f13kgozwf63std)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M24,621.5859 L24,648.5859 M11,629.5859 L37,629.5859 M24,648.5859 L11,663.5859 M24,648.5859 L37,663.5859 " fill="none" filter="url(#f13kgozwf63std)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f13kgozwf63std)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="130" x="66" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="73" y="72.9951">PowerOffWindow</text><rect fill="#FEFECE" filter="url(#f13kgozwf63std)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="130" x="66" y="587.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="73" y="607.2842">PowerOffWindow</text><rect fill="#FEFECE" filter="url(#f13kgozwf63std)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="89" x="210" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="217" y="72.9951">Application</text><rect fill="#FEFECE" filter="url(#f13kgozwf63std)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="89" x="210" y="587.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="217" y="607.2842">Application</text><rect fill="#FEFECE" filter="url(#f13kgozwf63std)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="129" x="369" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="376" y="72.9951">System Manager</text><rect fill="#FEFECE" filter="url(#f13kgozwf63std)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="129" x="369" y="587.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="376" y="607.2842">System Manager</text><rect fill="#FEFECE" filter="url(#f13kgozwf63std)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="90" x="579.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="586.5" y="72.9951">All services</text><rect fill="#FEFECE" filter="url(#f13kgozwf63std)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="90" x="579.5" y="587.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="586.5" y="607.2842">All services</text><rect fill="#FEFECE" filter="url(#f13kgozwf63std)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="153" x="704" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="711" y="72.9951">Application Manager</text><rect fill="#FEFECE" filter="url(#f13kgozwf63std)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="153" x="704" y="587.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="711" y="607.2842">Application Manager</text><rect fill="#FEFECE" filter="url(#f13kgozwf63std)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="92" x="920.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="927.5" y="72.9951">Service GUI</text><rect fill="#FEFECE" filter="url(#f13kgozwf63std)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="92" x="920.5" y="587.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="927.5" y="607.2842">Service GUI</text><rect fill="#FEFECE" filter="url(#f13kgozwf63std)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="98" x="1040.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1047.5" y="72.9951">service EINK</text><rect fill="#FEFECE" filter="url(#f13kgozwf63std)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="98" x="1040.5" y="587.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1047.5" y="607.2842">service EINK</text><polygon fill="#A80036" points="121,115.4297,131,119.4297,121,123.4297,125,119.4297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="24" x2="127" y1="119.4297" y2="119.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="31" y="114.3638">confirm close</text><polygon fill="#A80036" points="244.5,144.5625,254.5,148.5625,244.5,152.5625,248.5,148.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="133" x2="250.5" y1="148.5625" y2="148.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="140" y="143.4966">GUI off switch</text><polygon fill="#A80036" points="423.5,173.6953,433.5,177.6953,423.5,181.6953,427.5,177.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="256.5" x2="429.5" y1="177.6953" y2="177.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="263.5" y="172.6294">UserPowerDownRequest</text><polygon fill="#A80036" points="614.5,202.8281,624.5,206.8281,614.5,210.8281,618.5,206.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="435.5" x2="620.5" y1="206.8281" y2="206.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="442.5" y="201.7622">preCloseRoutine</text><polygon fill="#A80036" points="770.5,231.9609,780.5,235.9609,770.5,239.9609,774.5,235.9609" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="626.5" x2="776.5" y1="235.9609" y2="235.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="633.5" y="230.895">processCloseReason</text><line style="stroke:#A80036;stroke-width:1.0;" x1="782.5" x2="824.5" y1="265.0938" y2="265.0938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="824.5" x2="824.5" y1="265.0938" y2="278.0938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="783.5" x2="824.5" y1="278.0938" y2="278.0938"/><polygon fill="#A80036" points="793.5,274.0938,783.5,278.0938,793.5,282.0938,789.5,278.0938" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="789.5" y="260.0278">switchWindowAtClose(logo)</text><polygon fill="#A80036" points="979.5,303.2266,969.5,307.2266,979.5,311.2266,975.5,307.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="973.5" x2="1090.5" y1="307.2266" y2="307.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="985.5" y="302.1606">last sreen show</text><polygon fill="#A80036" points="637.5,332.3594,627.5,336.3594,637.5,340.3594,633.5,336.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="631.5" x2="967.5" y1="336.3594" y2="336.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="643.5" y="331.2935">ready to close</text><polygon fill="#A80036" points="446.5,361.4922,436.5,365.4922,446.5,369.4922,442.5,365.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="440.5" x2="625.5" y1="365.4922" y2="365.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="452.5" y="360.4263">readyToClose</text><path d="M359,380.4922 L423,380.4922 L423,387.4922 L413,397.4922 L359,397.4922 L359,380.4922 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="59.2656" style="stroke:#000000;stroke-width:2.0;" width="182.5" x="359" y="380.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="374" y="393.5591">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="59" x="438" y="392.7026">[timeout]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="435.5" x2="477.5" y1="418.7578" y2="418.7578"/><line style="stroke:#A80036;stroke-width:1.0;" x1="477.5" x2="477.5" y1="418.7578" y2="431.7578"/><line style="stroke:#A80036;stroke-width:1.0;" x1="436.5" x2="477.5" y1="431.7578" y2="431.7578"/><polygon fill="#A80036" points="446.5,427.7578,436.5,431.7578,446.5,435.7578,442.5,431.7578" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="442.5" y="413.6919">closeServices</text><polygon fill="#A80036" points="614.5,463.8906,624.5,467.8906,614.5,471.8906,618.5,467.8906" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="435.5" x2="620.5" y1="467.8906" y2="467.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="442.5" y="462.8247">SystemMessageType::Exit</text><polygon fill="#A80036" points="446.5,493.0234,436.5,497.0234,446.5,501.0234,442.5,497.0234" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="440.5" x2="625.5" y1="497.0234" y2="497.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="452.5" y="491.9575">MsgHandled</text><path d="M359,512.0234 L423,512.0234 L423,519.0234 L413,529.0234 L359,529.0234 L359,512.0234 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="59.2656" style="stroke:#000000;stroke-width:2.0;" width="160.5" x="359" y="512.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="374" y="525.0903">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="59" x="438" y="524.2339">[timeout]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="435.5" x2="477.5" y1="550.2891" y2="550.2891"/><line style="stroke:#A80036;stroke-width:1.0;" x1="477.5" x2="477.5" y1="550.2891" y2="563.2891"/><line style="stroke:#A80036;stroke-width:1.0;" x1="436.5" x2="477.5" y1="563.2891" y2="563.2891"/><polygon fill="#A80036" points="446.5,559.2891,436.5,563.2891,446.5,567.2891,442.5,563.2891" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="442.5" y="545.2231">kill service</text><!--MD5=[13bd41519717474e9d0f145e7a7409c3]
@startuml

actor User
participant "PowerOffWindow" as poff
participant "Application" as app
participant "System Manager" as sysmgr
participant "All services" as srv
participant "Application Manager" as appmgr
participant "Service GUI" as gui
participant "service EINK" as eink

User -> poff : confirm close
poff -> app : GUI off switch
app -> sysmgr : UserPowerDownRequest
sysmgr -> srv : preCloseRoutine

srv -> appmgr : processCloseReason
appmgr -> appmgr : switchWindowAtClose(logo)
eink -> gui : last sreen show
gui -> srv : ready to close

srv -> sysmgr : readyToClose
alt timeout
sysmgr -> sysmgr : closeServices
end
sysmgr -> srv : SystemMessageType::Exit
srv -> sysmgr : MsgHandled
alt timeout
sysmgr -> sysmgr : kill service
end

@enduml

PlantUML version 1.2021.00(Sun Jan 10 11:25:05 CET 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: pl
Country: PL
--></g></svg>