<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="520px" preserveAspectRatio="none" style="width:959px;height:520px;background:#F0F0F0;" version="1.1" viewBox="0 0 959 520" width="959px" zoomAndPan="magnify"><defs><filter height="300%" id="fhknj5rncvr09" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#F0F0F0" filter="url(#fhknj5rncvr09)" height="59.2656" style="stroke: #000000; stroke-width: 2.0;" width="182.5" x="59.5" y="272.2266"/><rect fill="#F0F0F0" filter="url(#fhknj5rncvr09)" height="59.2656" style="stroke: #000000; stroke-width: 2.0;" width="160.5" x="59.5" y="403.7578"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="135.5" x2="135.5" y1="38.2969" y2="480.0234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="327" x2="327" y1="38.2969" y2="480.0234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="482.5" x2="482.5" y1="38.2969" y2="480.0234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="778" x2="778" y1="38.2969" y2="480.0234"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="901" x2="901" y1="38.2969" y2="480.0234"/><rect fill="#FEFECE" filter="url(#fhknj5rncvr09)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="69.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="76.5" y="22.9951">System Manager</text><rect fill="#FEFECE" filter="url(#fhknj5rncvr09)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="69.5" y="479.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="76.5" y="499.0186">System Manager</text><rect fill="#FEFECE" filter="url(#fhknj5rncvr09)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="280" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="287" y="22.9951">All services</text><rect fill="#FEFECE" filter="url(#fhknj5rncvr09)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="280" y="479.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="287" y="499.0186">All services</text><rect fill="#FEFECE" filter="url(#fhknj5rncvr09)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="153" x="404.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="139" x="411.5" y="22.9951">Application Manager</text><rect fill="#FEFECE" filter="url(#fhknj5rncvr09)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="153" x="404.5" y="479.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="139" x="411.5" y="499.0186">Application Manager</text><rect fill="#FEFECE" filter="url(#fhknj5rncvr09)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="730" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="737" y="22.9951">Service GUI</text><rect fill="#FEFECE" filter="url(#fhknj5rncvr09)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="730" y="479.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="737" y="499.0186">Service GUI</text><rect fill="#FEFECE" filter="url(#fhknj5rncvr09)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="850" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="857" y="22.9951">service EINK</text><rect fill="#FEFECE" filter="url(#fhknj5rncvr09)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="850" y="479.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="857" y="499.0186">service EINK</text><polygon fill="#A80036" points="124,65.4297,134,69.4297,124,73.4297,128,69.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3" x2="130" y1="69.4297" y2="69.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="10" y="64.3638">battery brownout</text><polygon fill="#A80036" points="315,94.5625,325,98.5625,315,102.5625,319,98.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="136" x2="321" y1="98.5625" y2="98.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="143" y="93.4966">preCloseRoutine</text><polygon fill="#A80036" points="471,123.6953,481,127.6953,471,131.6953,475,127.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="327" x2="477" y1="127.6953" y2="127.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="334" y="122.6294">processCloseReason</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="483" x2="525" y1="156.8281" y2="156.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="525" x2="525" y1="156.8281" y2="169.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="484" x2="525" y1="169.8281" y2="169.8281"/><polygon fill="#A80036" points="494,165.8281,484,169.8281,494,173.8281,490,169.8281" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="281" x="490" y="151.7622">switchWindowAtClose(Dead Battery Window)</text><polygon fill="#A80036" points="789,194.9609,779,198.9609,789,202.9609,785,198.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="783" x2="900" y1="198.9609" y2="198.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="795" y="193.895">last sreen show</text><polygon fill="#A80036" points="338,224.0938,328,228.0938,338,232.0938,334,228.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="332" x2="777" y1="228.0938" y2="228.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="344" y="223.0278">ready to close</text><polygon fill="#A80036" points="147,253.2266,137,257.2266,147,261.2266,143,257.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="141" x2="326" y1="257.2266" y2="257.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="153" y="252.1606">readyToClose</text><path d="M59.5,272.2266 L123.5,272.2266 L123.5,279.2266 L113.5,289.2266 L59.5,289.2266 L59.5,272.2266 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="59.2656" style="stroke: #000000; stroke-width: 2.0;" width="182.5" x="59.5" y="272.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="74.5" y="285.2935">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="59" x="138.5" y="284.437">[timeout]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="136" x2="178" y1="310.4922" y2="310.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="178" x2="178" y1="310.4922" y2="323.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="137" x2="178" y1="323.4922" y2="323.4922"/><polygon fill="#A80036" points="147,319.4922,137,323.4922,147,327.4922,143,323.4922" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="143" y="305.4263">closeServices</text><polygon fill="#A80036" points="315,355.625,325,359.625,315,363.625,319,359.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="136" x2="321" y1="359.625" y2="359.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="143" y="354.5591">SystemMessageType::Exit</text><polygon fill="#A80036" points="147,384.7578,137,388.7578,147,392.7578,143,388.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="141" x2="326" y1="388.7578" y2="388.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="153" y="383.6919">MsgHandled</text><path d="M59.5,403.7578 L123.5,403.7578 L123.5,410.7578 L113.5,420.7578 L59.5,420.7578 L59.5,403.7578 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="59.2656" style="stroke: #000000; stroke-width: 2.0;" width="160.5" x="59.5" y="403.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="74.5" y="416.8247">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="59" x="138.5" y="415.9683">[timeout]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="136" x2="178" y1="442.0234" y2="442.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="178" x2="178" y1="442.0234" y2="455.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="137" x2="178" y1="455.0234" y2="455.0234"/><polygon fill="#A80036" points="147,451.0234,137,455.0234,147,459.0234,143,455.0234" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="143" y="436.9575">kill service</text><!--MD5=[210197d7022123c369a910652d598c70]
@startuml
skinparam BackgroundColor F0F0F0

participant "System Manager" as sysmgr
participant "All services" as srv
participant "Application Manager" as appmgr
participant "Service GUI" as gui
participant "service EINK" as eink

-> sysmgr : battery brownout
sysmgr -> srv : preCloseRoutine

srv -> appmgr : processCloseReason
appmgr -> appmgr : switchWindowAtClose(Dead Battery Window)
eink -> gui : last sreen show
gui -> srv : ready to close

srv -> sysmgr : readyToClose
alt timeout
sysmgr -> sysmgr : closeServices
end
sysmgr -> srv : SystemMessageType::Exit
srv -> sysmgr : MsgHandled
alt timeout
sysmgr -> sysmgr : kill service
end

@enduml

PlantUML version 1.2020.02(Sun Mar 01 05:22:07 EST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.12+7-post-Debian-2
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>