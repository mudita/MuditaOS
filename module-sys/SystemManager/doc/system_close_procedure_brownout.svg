<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="564px" preserveAspectRatio="none" style="width:938px;height:564px;background:#F0F0F0;" version="1.1" viewBox="0 0 938 564" width="938px" zoomAndPan="magnify"><defs><filter height="300%" id="f1pw8gm80p6qkb" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#F0F0F0" filter="url(#f1pw8gm80p6qkb)" height="64.412" style="stroke:#000000;stroke-width:2.0;" width="172.5" x="55.5" y="295.01"/><rect fill="#F0F0F0" filter="url(#f1pw8gm80p6qkb)" height="64.412" style="stroke:#000000;stroke-width:2.0;" width="154.5" x="55.5" y="436.8341"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="130.5" x2="130.5" y1="43.0679" y2="518.2461"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="330.5" x2="330.5" y1="43.0679" y2="518.2461"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="476.5" x2="476.5" y1="43.0679" y2="518.2461"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="760.5" x2="760.5" y1="43.0679" y2="518.2461"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="877" x2="877" y1="43.0679" y2="518.2461"/><rect fill="#FEFECE" filter="url(#f1pw8gm80p6qkb)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="127" x="65.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="72.5" y="26.9659">System Manager</text><rect fill="#FEFECE" filter="url(#f1pw8gm80p6qkb)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="127" x="65.5" y="517.2461"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="72.5" y="539.2121">System Manager</text><rect fill="#FEFECE" filter="url(#f1pw8gm80p6qkb)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="89" x="284.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="291.5" y="26.9659">All services</text><rect fill="#FEFECE" filter="url(#f1pw8gm80p6qkb)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="89" x="284.5" y="517.2461"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="291.5" y="539.2121">All services</text><rect fill="#FEFECE" filter="url(#f1pw8gm80p6qkb)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="155" x="397.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="404.5" y="26.9659">Application Manager</text><rect fill="#FEFECE" filter="url(#f1pw8gm80p6qkb)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="155" x="397.5" y="517.2461"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="404.5" y="539.2121">Application Manager</text><rect fill="#FEFECE" filter="url(#f1pw8gm80p6qkb)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="91" x="713.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="720.5" y="26.9659">Service GUI</text><rect fill="#FEFECE" filter="url(#f1pw8gm80p6qkb)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="91" x="713.5" y="517.2461"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="720.5" y="539.2121">Service GUI</text><rect fill="#FEFECE" filter="url(#f1pw8gm80p6qkb)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="98" x="826" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="833" y="26.9659">service EINK</text><rect fill="#FEFECE" filter="url(#f1pw8gm80p6qkb)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="98" x="826" y="517.2461"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="833" y="539.2121">service EINK</text><polygon fill="#A80036" points="119,72.7739,129,76.7739,119,80.7739,123,76.7739" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="0" x2="125" y1="76.7739" y2="76.7739"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="7" y="70.9649">battery brownout</text><polygon fill="#A80036" points="319,104.4799,329,108.4799,319,112.4799,323,108.4799" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="131" x2="325" y1="108.4799" y2="108.4799"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="138" y="102.6709">InitiateSystemCloseSequence</text><polygon fill="#A80036" points="465,136.186,475,140.186,465,144.186,469,140.186" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="331" x2="471" y1="140.186" y2="140.186"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="338" y="134.377">processCloseReason</text><line style="stroke:#A80036;stroke-width:1.0;" x1="477" x2="519" y1="171.892" y2="171.892"/><line style="stroke:#A80036;stroke-width:1.0;" x1="519" x2="519" y1="171.892" y2="184.892"/><line style="stroke:#A80036;stroke-width:1.0;" x1="478" x2="519" y1="184.892" y2="184.892"/><polygon fill="#A80036" points="488,180.892,478,184.892,488,188.892,484,184.892" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270" x="484" y="166.083">switchWindowAtClose(Dead Battery Window)</text><polygon fill="#A80036" points="772,212.598,762,216.598,772,220.598,768,216.598" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="766" x2="876" y1="216.598" y2="216.598"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="778" y="210.789">last sreen show</text><polygon fill="#A80036" points="342,244.304,332,248.304,342,252.304,338,248.304" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="336" x2="760" y1="248.304" y2="248.304"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="348" y="242.495">ready to close</text><polygon fill="#A80036" points="142,276.01,132,280.01,142,284.01,138,280.01" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="136" x2="330" y1="280.01" y2="280.01"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="148" y="274.201">readyToClose</text><path d="M55.5,295.01 L118.5,295.01 L118.5,304.01 L108.5,314.01 L55.5,314.01 L55.5,295.01 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="64.412" style="stroke:#000000;stroke-width:2.0;" width="172.5" x="55.5" y="295.01"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="70.5" y="309.907">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="53" x="133.5" y="308.7689">[timeout]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="131" x2="173" y1="338.4221" y2="338.4221"/><line style="stroke:#A80036;stroke-width:1.0;" x1="173" x2="173" y1="338.4221" y2="351.4221"/><line style="stroke:#A80036;stroke-width:1.0;" x1="132" x2="173" y1="351.4221" y2="351.4221"/><polygon fill="#A80036" points="142,347.4221,132,351.4221,142,355.4221,138,351.4221" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="138" y="332.6131">closeServices</text><polygon fill="#A80036" points="319,386.1281,329,390.1281,319,394.1281,323,390.1281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="131" x2="325" y1="390.1281" y2="390.1281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="138" y="384.3191">SystemMessageType::Exit</text><polygon fill="#A80036" points="142,417.8341,132,421.8341,142,425.8341,138,421.8341" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="136" x2="330" y1="421.8341" y2="421.8341"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="148" y="416.0251">MsgHandled</text><path d="M55.5,436.8341 L118.5,436.8341 L118.5,445.8341 L108.5,455.8341 L55.5,455.8341 L55.5,436.8341 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="64.412" style="stroke:#000000;stroke-width:2.0;" width="154.5" x="55.5" y="436.8341"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="70.5" y="451.7311">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="53" x="133.5" y="450.593">[timeout]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="131" x2="173" y1="480.2461" y2="480.2461"/><line style="stroke:#A80036;stroke-width:1.0;" x1="173" x2="173" y1="480.2461" y2="493.2461"/><line style="stroke:#A80036;stroke-width:1.0;" x1="132" x2="173" y1="493.2461" y2="493.2461"/><polygon fill="#A80036" points="142,489.2461,132,493.2461,142,497.2461,138,493.2461" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="138" y="474.4371">kill service</text><!--MD5=[dc32efee2c8c59b6247c204766715b97]
@startuml
skinparam BackgroundColor F0F0F0

participant "System Manager" as sysmgr
participant "All services" as srv
participant "Application Manager" as appmgr
participant "Service GUI" as gui
participant "service EINK" as eink

-> sysmgr : battery brownout
sysmgr -> srv : InitiateSystemCloseSequence

srv -> appmgr : processCloseReason
appmgr -> appmgr : switchWindowAtClose(Dead Battery Window)
eink -> gui : last sreen show
gui -> srv : ready to close

srv -> sysmgr : readyToClose
alt timeout
sysmgr -> sysmgr : closeServices
end
sysmgr -> srv : SystemMessageType::Exit
srv -> sysmgr : MsgHandled
alt timeout
sysmgr -> sysmgr : kill service
end

@enduml

PlantUML version 1.2021.7(Sun May 23 14:40:07 CEST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>