if (NOT IS_SYMLINK "${CMAKE_BINARY_DIR}/sys/user")
    file(MAKE_DIRECTORY "${CMAKE_BINARY_DIR}/sys/user")
endif()

add_catch2_executable(
    NAME
        db
    SRCS
        AlarmsRecord_tests.cpp
        AlarmsTable_tests.cpp
        CalllogRecord_tests.cpp
        CalllogTable_tests.cpp
        ContactGroups_tests.cpp
        ContactsAddressTable_tests.cpp
        ContactsNameTable_tests.cpp
        ContactsNumberTable_tests.cpp
        ContactsRecord_tests.cpp
        ContactsRingtonesTable_tests.cpp
        ContactsTable_tests.cpp
        DbInitializer.cpp
        NotesRecord_tests.cpp
        NotesTable_tests.cpp
        NotificationsRecord_tests.cpp
        NotificationsTable_tests.cpp
        QueryInterface.cpp
        SMSRecord_tests.cpp
        SMSTable_tests.cpp
        SMSTemplateRecord_tests.cpp
        SMSTemplateTable_tests.cpp
        ThreadRecord_tests.cpp
        ThreadsTable_tests.cpp
        tests-main.cpp
        common.cpp
        
    LIBS
        module-sys
        iosyscalls
        module-db
        json::json
    DEPS
        assets
        PurePhone-disk-img
)
add_subdirectory(test-initializer)
